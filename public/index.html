<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Mortgage, Auto & Rent vs. Buy Calculator | Calcyourlator</title>
    <meta name="description" content="Use our free, high-authority financial calculators to estimate mortgage payments, auto loans, and rent vs. buy scenarios. Features live FRED rates and full amortization schedules.">
    
    <!-- Fonts & Scripts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { 'bk-blue': '#0056b3', 'bk-text': '#212529', 'bk-sidebar': '#f8f9fa', 'bk-white': '#ffffff' },
                    fontFamily: { sans: ['Inter', 'sans-serif'] }
                }
            }
        }
    </script>

    <style>
        body { color: #212529; background-color: #ffffff; }
        .main-grid-container { display: flex; align-items: flex-start; gap: 2.5rem; justify-content: center; max-width: 1280px; margin: 0 auto; padding: 0 20px; width: 100%; }
        .sidebar-card { width: 100%; background: white; border-radius: 0.75rem; border: 1px solid #e5e7eb; box-shadow: 0 1px 3px rgba(0,0,0,0.1); overflow: hidden; }
        .left-column { flex: 1; max-width: 650px; min-width: 0; }
        .right-pillar-sidebar { width: 440px; flex-shrink: 0; }
        .bk-input { width: 100%; border: 1px solid #ced4da; border-radius: 0.25rem; padding: 0.5rem 0.75rem; font-weight: 600; }
        .bk-label { font-size: 0.85rem; font-weight: 700; margin-bottom: 0.25rem; display: block; }
        .bk-tab { padding: 1rem 1.5rem; font-weight: 700; color: #6c757d; border-bottom: 4px solid transparent; cursor: pointer; transition: color 0.2s; }
        .bk-tab.active { color: #0056b3; border-bottom-color: #0056b3; }
        .am-table { table-layout: fixed; width: 100%; }
        .am-table th, .am-table td { padding: 0.75rem; text-align: center; border-top: 1px solid #dee2e6; font-size: 0.875rem; }
        @media (max-width: 1023px) { .main-grid-container { flex-direction: column; align-items: center; } .left-column, .right-pillar-sidebar { width: 100% !important; } }
        @media (min-width: 1024px) { aside { position: sticky; top: 20px; height: fit-content; } }
    </style>
</head>

<body class="flex flex-col min-h-screen">
    <!-- Navigation -->
    <nav class="bg-white border-b border-gray-200">
        <div class="max-w-[1280px] mx-auto px-4 h-[100px] flex items-center justify-between">
            <div class="flex items-center">
                <div class="bg-bk-blue text-white font-black text-xl px-2 py-1 rounded mr-2">C</div>
                <span class="font-extrabold text-xl tracking-tight text-bk-blue">Calcyour<span class="text-green-600">lator</span></span>
            </div>
            <div id="header-ad-hub" class="hidden md:flex w-[728px] h-[90px] bg-gray-100 items-center justify-center text-[10px] text-gray-400 font-bold uppercase border">Advertisement</div>
        </div>
    </nav>

    <!-- Tool Tabs -->
    <div class="border-b border-gray-200 bg-white">
        <div class="max-w-7xl mx-auto px-4 flex overflow-x-auto">
            <button id="tabMortgage" class="bk-tab active">Mortgage</button>
            <button id="tabAuto" class="bk-tab">Auto Loan</button>
            <button id="tabRentBuy" class="bk-tab">Rent versus Buy Comparison</button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-grid-container py-6 lg:py-8">
        <main class="left-column space-y-8">
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-5">
                <h2 class="text-xl font-bold mb-4" id="inputTitle">Loan Details</h2>
                
                <!-- Mortgage Inputs -->
                <div id="mortgageInputs" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="bk-label">Home Price</label>
                            <div class="relative"><span class="absolute left-3 top-2 text-gray-500 font-bold">$</span>
                            <input type="number" id="homePrice" class="bk-input pl-7" value="300000"></div>
                        </div>
                        <div>
                            <label class="bk-label">Down Payment (<span id="dpPercent">20%</span>)</label>
                            <div class="relative"><span class="absolute left-3 top-2 text-gray-500 font-bold">$</span>
                            <input type="number" id="downPayment" class="bk-input pl-7" value="60000"></div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="bk-label">Interest Rate</label>
                            <div class="relative"><input type="number" id="interestRate" class="bk-input pr-8" step="0.01" value="6.85">
                            <span class="absolute right-3 top-2 text-gray-500 font-bold">%</span></div>
                            <p class="text-xs text-green-600 mt-1" id="rateSource">Loading live rates...</p>
                        </div>
                        <div>
                            <label class="bk-label">Loan Term (Years)</label>
                            <div class="grid grid-cols-4 gap-2">
                                <button class="term-btn py-2 text-sm font-bold border rounded bg-bk-blue text-white" data-val="30">30</button>
                                <button class="term-btn py-2 text-sm font-bold border rounded bg-white text-gray-600" data-val="20">20</button>
                                <button class="term-btn py-2 text-sm font-bold border rounded bg-white text-gray-600" data-val="15">15</button>
                                <button class="term-btn py-2 text-sm font-bold border rounded bg-white text-gray-600" data-val="10">10</button>
                            </div>
                            <input type="hidden" id="loanTerm" value="30">
                        </div>
                    </div>
                    <div class="pt-4 border-t border-gray-200">
                        <button class="text-sm font-bold text-bk-blue hover:underline" onclick="document.getElementById('advInputs').classList.toggle('hidden')">+ Advanced (Tax, Ins, HOA, PMI)</button>
                        <div id="advInputs" class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 pt-4">
                            <div><label class="bk-label text-xs">Prop Tax /yr (%)</label><input type="number" id="propertyTax" class="bk-input" value="1.2" step="0.1"></div>
                            <div><label class="bk-label text-xs">Home Ins /yr ($)</label><input type="number" id="homeIns" class="bk-input" value="1500"></div>
                            <div><label class="bk-label text-xs">HOA /mo ($)</label><input type="number" id="hoa" class="bk-input" value="0"></div>
                            <div><label class="bk-label text-xs">PMI /yr (%)</label><input type="number" id="pmiRate" class="bk-input" value="0" step="0.01"></div>
                        </div>
                    </div>
                </div>

                <!-- Auto & Rent/Buy Inputs (Simplified placeholders) -->
                <div id="autoInputs" class="hidden space-y-4">
                     <label class="bk-label">Vehicle Price</label>
                     <input type="number" id="autoPrice" class="bk-input" value="35000">
                </div>
                <div id="rbInputs" class="hidden space-y-4">
                     <label class="bk-label">Monthly Rent</label>
                     <input type="number" id="rbRent" class="bk-input" value="2200">
                </div>
            </div>

            <!-- Amortization Section -->
            <details id="amortizationSection" class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                <summary class="text-sm font-bold text-bk-blue cursor-pointer uppercase flex items-center list-none">
                    <span>View Full Amortization Schedule</span>
                </summary>
                <div class="overflow-x-auto mt-4 border rounded-lg">
                    <table class="w-full am-table text-xs">
                        <thead class="bg-blue-50">
                            <tr><th>DATE</th><th>PRINCIPAL</th><th>INTEREST</th><th>PMI</th><th>BALANCE</th></tr>
                        </thead>
                        <tbody id="scheduleBody"></tbody>
                    </table>
                </div>
            </details>
        </main>

        <!-- Sidebar Results -->
        <aside class="right-pillar-sidebar space-y-4">
            <div id="resultsCard" class="sidebar-card p-4">
                <h2 class="text-[10px] font-bold text-gray-500 uppercase tracking-wide">Estimated Monthly Payment</h2>
                <div class="flex items-baseline text-bk-blue pb-1">
                    <span class="text-4xl font-extrabold" id="bigVal">$0</span>
                    <span class="ml-1 text-base font-medium text-gray-400">/mo</span>
                </div>
                <div class="h-40 relative flex justify-center"><canvas id="resultChart"></canvas></div>
                <div id="breakdown" class="space-y-1"></div>
            </div>
            <div class="sidebar-card bg-gray-50 p-4 text-center">
                <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2">Sponsored Ad Space</p>
                <p class="text-sm font-bold text-bk-blue">Compare Today's Best Rates &rarr;</p>
            </div>
            <div class="sidebar-card p-3">
                <details class="group">
                    <summary class="text-[10px] font-bold text-gray-500 uppercase cursor-pointer flex items-center list-none">Calculation Methodology & Accuracy</summary>
                    <div class="mt-2 text-[11px] text-gray-600 bg-gray-50 p-2 rounded leading-relaxed">
                        Calculations use industry-standard fixed-rate algorithms. We leverage market benchmarks from the Federal Reserve Economic Data (FRED).
                    </div>
                </details>
            </div>
        </aside>
    </div>

    <!-- Global Footer -->
    <footer class="mt-auto py-8 bg-gray-50 border-t">
        <div class="max-w-[1280px] mx-auto px-5 text-center">
            <div class="flex flex-wrap justify-center gap-4 text-xs font-semibold text-gray-600 mb-4">
                <a href="index.html" class="hover:text-bk-blue underline">Home</a>
                <a href="about.html" class="hover:text-bk-blue underline">About Us</a>
                <a href="privacy.html" class="hover:text-bk-blue underline">Privacy Policy</a>
                <a href="terms.html" class="hover:text-bk-blue underline">Terms of Use</a>
                <a href="cookies.html" class="hover:text-bk-blue underline">Cookie Settings</a>
                <a href="contact.html" class="hover:text-bk-blue underline">Contact Us</a>
            </div>
            <p class="text-[11px] text-gray-400">By using this site, you agree to our Terms of Use and Privacy Policy, including our use of cookies.</p>
        </div>
    </footer>

    <!-- Financial Logic -->
    <script>
        // Scaling & Scale Protection: Initialize with Fallbacks [Audit Notes]
        let FRED_DATA = { 30: { val: 6.85, date: 'Market Average' }, 15: { val: 6.15, date: 'Market Average' } };
        const S = { mode: 'mortgage', mp: 300000, mdown: 60000, mdpPct: 20, mrate: 6.85, mterm: 30, mtax: 1.2, mins: 1500, mhoa: 0, mpmi: 0 };
        
        const el = (id) => document.getElementById(id);
        const fmt = (n) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(n);
        let chart;

        async function fetchFred() {
            try {
                // Static Bridge: Fetch from local public folder
                const response = await fetch('./rates.json');
                if (!response.ok) throw new Error("Rates file not ready");
                const data = await response.json();
                
                // Parse standard FRED JSON structure from GitHub Action
                const v30 = parseFloat(data.observations.value);
                const d30 = new Date(data.observations.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                
                if (v30) {
                    FRED_DATA[1] = { val: v30, date: d30 };
                    el('rateSource').innerText = `Live FRED Rate: ${v30}% (${d30})`;
                    if (S.mterm === 30) { el('interestRate').value = v30; update(); }
                }
            } catch (e) {
                console.log("Using Market Average Fallback", e);
                el('rateSource').innerText = "Market Average Rate";
            }
        }

        function update() {
            S.mp = parseFloat(el('homePrice').value) || 0;
            S.mdown = parseFloat(el('downPayment').value) || 0;
            S.mrate = parseFloat(el('interestRate').value) || 0;
            
            const loan = S.mp - S.mdown;
            const r = (S.mrate / 100) / 12;
            const n = S.mterm * 12;
            const pi = (loan > 0 && r > 0) ? (loan * r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1) : 0;
            const moTax = (S.mp * (S.mtax / 100)) / 12;
            const moIns = S.mins / 12;
            const total = pi + moTax + moIns + S.mhoa;

            el('bigVal').innerText = fmt(total);
            renderChart([pi, moTax, moIns, S.mhoa], ['P&I', 'Tax', 'Ins', 'HOA'], ['#0056b3', '#28a745', '#adb5bd', '#dee2e6']);
        }

        function renderChart(data, labels, colors) {
            if (!chart) {
                const ctx = el('resultChart').getContext('2d');
                chart = new Chart(ctx, {
                    type: 'doughnut',
                    data: { labels: labels, datasets: [{ data: data, backgroundColor: colors, borderWidth: 0 }] },
                    options: { responsive: true, maintainAspectRatio: false, cutout: '70%', plugins: { legend: { display: false } } }
                });
            } else {
                chart.data.datasets.data = data;
                chart.update();
            }
        }

        function setTerm(y) {
            S.mterm = parseInt(y);
            document.querySelectorAll('.term-btn').forEach(b => {
                b.className = b.dataset.val == y ? "term-btn py-2 text-sm font-bold border rounded bg-bk-blue text-white" : "term-btn py-2 text-sm font-bold border rounded bg-white text-gray-600";
            });
            update();
        }

        // Initialize WebApplication Schema [115, Audit Notes]
        const schema = {
            "@context": "https://schema.org",
            "@type": "WebApplication",
            "name": "Free Mortgage, Auto & Rent vs. Buy Calculator",
            "applicationCategory": "FinanceApplication",
            "operatingSystem": "All",
            "provider": { "@type": "Organization", "name": "Calcyourlator" }
        };
        const script = document.createElement('script');
        script.type = 'application/ld+json';
        script.text = JSON.stringify(schema);
        document.head.appendChild(script);

        document.querySelectorAll('input').forEach(i => i.oninput = update);
        document.querySelectorAll('.term-btn').forEach(b => b.onclick = () => setTerm(b.dataset.val));
        
        window.onload = () => { fetchFred(); update(); };
    </script>
</body>
</html>
